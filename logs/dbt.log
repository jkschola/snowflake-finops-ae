[0m12:37:26.816795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FC9481EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCAA8A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCC901BE0>]}


============================== 12:37:26.816795 | d1e28f0f-752b-40e9-ab8a-f69607fad465 ==============================
[0m12:37:26.816795 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:37:26.816795 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt init snowflake_finops', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m12:37:26.832416 [debug] [MainThread]: Starter project path: C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\venv\Lib\site-packages\dbt\include\starter_project
[0m12:37:26.874528 [info ] [MainThread]: 
Your new dbt project "snowflake_finops" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m12:37:26.875501 [info ] [MainThread]: Setting up your profile.
[0m12:38:11.354937 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:38:11.354937 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:38:11.354937 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:43:47.915113 [info ] [MainThread]: Profile snowflake_finops written to C:\Users\jksch\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:43:47.929415 [debug] [MainThread]: Command `dbt init` succeeded at 12:43:47.928268 after 381.23 seconds
[0m12:43:47.930126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCCBE82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCF592570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCF5C2810>]}
[0m12:43:47.930126 [debug] [MainThread]: Flushing usage events
[0m12:43:48.653963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:15.572529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3EEDD49B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F182FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F17A8980>]}


============================== 13:00:15.572529 | df566632-c080-43b1-9e96-731b6e378beb ==============================
[0m13:00:15.572529 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:00:15.572529 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m13:00:15.599655 [info ] [MainThread]: dbt version: 1.11.2
[0m13:00:15.606234 [info ] [MainThread]: python version: 3.12.9
[0m13:00:15.606234 [info ] [MainThread]: python path: C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\venv\Scripts\python.exe
[0m13:00:15.607231 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:00:15.935921 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:00:15.935921 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:00:15.935921 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:00:16.029649 [info ] [MainThread]: Using profiles dir at C:\Users\jksch\.dbt
[0m13:00:16.029649 [info ] [MainThread]: Using profiles.yml file at C:\Users\jksch\.dbt\profiles.yml
[0m13:00:16.029649 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\dbt_project.yml
[0m13:00:16.029649 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m13:00:16.029649 [debug] [MainThread]: Command `dbt debug` failed at 13:00:16.029649 after 0.59 seconds
[0m13:00:16.029649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F1531610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F4499C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F3DAA570>]}
[0m13:00:16.029649 [debug] [MainThread]: Flushing usage events
[0m13:00:16.751922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:04.191322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020334C69340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203314C11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033262F470>]}


============================== 13:17:04.191322 | 80b95ffd-5ad9-4698-b5fc-3e6515864bf0 ==============================
[0m13:17:04.191322 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:17:04.206943 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m13:17:04.225186 [info ] [MainThread]: dbt version: 1.11.2
[0m13:17:04.227233 [info ] [MainThread]: python version: 3.12.9
[0m13:17:04.227726 [info ] [MainThread]: python path: C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\venv\Scripts\python.exe
[0m13:17:04.228016 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:17:04.583603 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:17:04.583603 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:17:04.583603 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:17:04.651451 [info ] [MainThread]: Using profiles dir at C:\Users\jksch\.dbt
[0m13:17:04.653155 [info ] [MainThread]: Using profiles.yml file at C:\Users\jksch\.dbt\profiles.yml
[0m13:17:04.653700 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\dbt_project.yml
[0m13:17:04.654698 [info ] [MainThread]: adapter type: snowflake
[0m13:17:04.654698 [info ] [MainThread]: adapter version: 1.11.1
[0m13:17:04.764869 [info ] [MainThread]: Configuration:
[0m13:17:04.764878 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:17:04.764878 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:17:04.764878 [info ] [MainThread]: Required dependencies:
[0m13:17:04.764878 [debug] [MainThread]: Executing "git --help"
[0m13:17:04.845628 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:17:04.845628 [debug] [MainThread]: STDERR: "b''"
[0m13:17:04.845628 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:17:04.846787 [info ] [MainThread]: Connection:
[0m13:17:04.847470 [info ] [MainThread]:   account: jjdgisq-heb30395
[0m13:17:04.847470 [info ] [MainThread]:   user: FINOPS_DBT_USER
[0m13:17:04.848290 [info ] [MainThread]:   database: FINOPS_DEV
[0m13:17:04.848290 [info ] [MainThread]:   warehouse: FINOPS_WH
[0m13:17:04.849292 [info ] [MainThread]:   role: FINOPS_TRANSFORMER_ROLE
[0m13:17:04.849292 [info ] [MainThread]:   schema: dbt_JKU
[0m13:17:04.850285 [info ] [MainThread]:   authenticator: None
[0m13:17:04.850285 [info ] [MainThread]:   oauth_client_id: None
[0m13:17:04.850285 [info ] [MainThread]:   query_tag: None
[0m13:17:04.851282 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:17:04.851282 [info ] [MainThread]:   host: None
[0m13:17:04.852371 [info ] [MainThread]:   port: None
[0m13:17:04.853075 [info ] [MainThread]:   proxy_host: None
[0m13:17:04.853307 [info ] [MainThread]:   proxy_port: None
[0m13:17:04.854074 [info ] [MainThread]:   protocol: None
[0m13:17:04.854479 [info ] [MainThread]:   connect_retries: 1
[0m13:17:04.854479 [info ] [MainThread]:   connect_timeout: None
[0m13:17:04.855522 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:17:04.855914 [info ] [MainThread]:   retry_all: False
[0m13:17:04.855914 [info ] [MainThread]:   insecure_mode: False
[0m13:17:04.856851 [info ] [MainThread]:   reuse_connections: True
[0m13:17:04.856851 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:17:04.856851 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:17:04.856851 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m13:17:05.214024 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:17:07.782650 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:17:07.782650 [debug] [MainThread]: On debug: select 1 as id
[0m13:17:07.782650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:08.704889 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:17:08.704889 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:17:08.704889 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:17:08.704889 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:17:08.704889 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: jjdgisq-heb30395.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:17:08.720243 [debug] [MainThread]: Command `dbt debug` failed at 13:17:08.720243 after 4.64 seconds
[0m13:17:08.720243 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:17:08.720243 [debug] [MainThread]: On debug: No close available on handle
[0m13:17:08.720243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020335142FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020332CEC7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203346E4140>]}
[0m13:17:08.720243 [debug] [MainThread]: Flushing usage events
[0m13:17:09.426608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:31.031997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AEB1394C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AEAABAB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AEAAB9970>]}


============================== 14:11:31.040250 | 12716939-dbbb-447e-bd5c-33efd07b0c96 ==============================
[0m14:11:31.040250 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:11:31.041250 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m14:11:31.076158 [info ] [MainThread]: dbt version: 1.11.2
[0m14:11:31.077151 [info ] [MainThread]: python version: 3.12.9
[0m14:11:31.077735 [info ] [MainThread]: python path: C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\venv\Scripts\python.exe
[0m14:11:31.077735 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:11:31.651596 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:11:31.651596 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:11:31.651596 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:11:31.729728 [info ] [MainThread]: Using profiles dir at C:\Users\jksch\.dbt
[0m14:11:31.729728 [info ] [MainThread]: Using profiles.yml file at C:\Users\jksch\.dbt\profiles.yml
[0m14:11:31.729728 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\dbt_project.yml
[0m14:11:31.729728 [info ] [MainThread]: adapter type: snowflake
[0m14:11:31.729728 [info ] [MainThread]: adapter version: 1.11.1
[0m14:11:31.851412 [info ] [MainThread]: Configuration:
[0m14:11:31.852409 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:11:31.852409 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:11:31.853406 [info ] [MainThread]: Required dependencies:
[0m14:11:31.853406 [debug] [MainThread]: Executing "git --help"
[0m14:11:31.955747 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:11:31.956745 [debug] [MainThread]: STDERR: "b''"
[0m14:11:31.956745 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:11:31.957741 [info ] [MainThread]: Connection:
[0m14:11:31.957741 [info ] [MainThread]:   account: jjdgisq-heb30395
[0m14:11:31.957741 [info ] [MainThread]:   user: FINOPS_DBT_USER
[0m14:11:31.958919 [info ] [MainThread]:   database: FINOPS_DEV
[0m14:11:31.958919 [info ] [MainThread]:   warehouse: FINOPS_WH
[0m14:11:31.959918 [info ] [MainThread]:   role: FINOPS_TRANSFORMER_ROLE
[0m14:11:31.959918 [info ] [MainThread]:   schema: dbt_JKU
[0m14:11:31.960914 [info ] [MainThread]:   authenticator: None
[0m14:11:31.961455 [info ] [MainThread]:   oauth_client_id: None
[0m14:11:31.962052 [info ] [MainThread]:   query_tag: None
[0m14:11:31.962052 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:11:31.962952 [info ] [MainThread]:   host: None
[0m14:11:31.962952 [info ] [MainThread]:   port: None
[0m14:11:31.963951 [info ] [MainThread]:   proxy_host: None
[0m14:11:31.963951 [info ] [MainThread]:   proxy_port: None
[0m14:11:31.964947 [info ] [MainThread]:   protocol: None
[0m14:11:31.964947 [info ] [MainThread]:   connect_retries: 1
[0m14:11:31.965956 [info ] [MainThread]:   connect_timeout: None
[0m14:11:31.965956 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:11:31.967161 [info ] [MainThread]:   retry_all: False
[0m14:11:31.967663 [info ] [MainThread]:   insecure_mode: False
[0m14:11:31.968170 [info ] [MainThread]:   reuse_connections: True
[0m14:11:31.968170 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m14:11:31.968170 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m14:11:31.969169 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:11:32.366554 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:11:32.543897 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:11:32.543897 [debug] [MainThread]: On debug: select 1 as id
[0m14:11:32.559520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:34.155273 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.604 seconds
[0m14:11:34.155273 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:11:34.155273 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:11:34.155273 [debug] [MainThread]: Command `dbt debug` succeeded at 14:11:34.155273 after 3.30 seconds
[0m14:11:34.155273 [debug] [MainThread]: Connection 'debug' was left open.
[0m14:11:34.155273 [debug] [MainThread]: On debug: Close
[0m14:11:34.533606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AEB10CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AED690500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AED4C6600>]}
[0m14:11:34.533606 [debug] [MainThread]: Flushing usage events
[0m14:11:35.275369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:09.998120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A4CFF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A447B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A447BDD0>]}


============================== 14:22:09.998120 | 174eaf89-fa11-4870-9757-12399af2e0d2 ==============================
[0m14:22:09.998120 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:22:09.998120 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m14:22:10.013741 [info ] [MainThread]: dbt version: 1.11.2
[0m14:22:10.013741 [info ] [MainThread]: python version: 3.12.9
[0m14:22:10.028445 [info ] [MainThread]: python path: C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\venv\Scripts\python.exe
[0m14:22:10.028445 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:22:10.391431 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:22:10.391431 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:22:10.391431 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:22:10.453941 [info ] [MainThread]: Using profiles dir at C:\Users\jksch\.dbt
[0m14:22:10.453941 [info ] [MainThread]: Using profiles.yml file at C:\Users\jksch\.dbt\profiles.yml
[0m14:22:10.453941 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\dbt_project.yml
[0m14:22:10.453941 [info ] [MainThread]: adapter type: snowflake
[0m14:22:10.453941 [info ] [MainThread]: adapter version: 1.11.1
[0m14:22:10.563332 [info ] [MainThread]: Configuration:
[0m14:22:10.563332 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:22:10.578954 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:10.578954 [info ] [MainThread]: Required dependencies:
[0m14:22:10.578954 [debug] [MainThread]: Executing "git --help"
[0m14:22:10.649698 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:22:10.649698 [debug] [MainThread]: STDERR: "b''"
[0m14:22:10.649698 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:22:10.649698 [info ] [MainThread]: Connection:
[0m14:22:10.649698 [info ] [MainThread]:   account: jjdgisq-heb30395
[0m14:22:10.649698 [info ] [MainThread]:   user: FINOPS_DBT_USER
[0m14:22:10.649698 [info ] [MainThread]:   database: FINOPS_DEV
[0m14:22:10.649698 [info ] [MainThread]:   warehouse: FINOPS_WH
[0m14:22:10.649698 [info ] [MainThread]:   role: FINOPS_TRANSFORMER_ROLE
[0m14:22:10.649698 [info ] [MainThread]:   schema: dbt_JKU
[0m14:22:10.649698 [info ] [MainThread]:   authenticator: None
[0m14:22:10.649698 [info ] [MainThread]:   oauth_client_id: None
[0m14:22:10.649698 [info ] [MainThread]:   query_tag: None
[0m14:22:10.649698 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:22:10.649698 [info ] [MainThread]:   host: None
[0m14:22:10.649698 [info ] [MainThread]:   port: None
[0m14:22:10.663140 [info ] [MainThread]:   proxy_host: None
[0m14:22:10.663140 [info ] [MainThread]:   proxy_port: None
[0m14:22:10.664142 [info ] [MainThread]:   protocol: None
[0m14:22:10.664719 [info ] [MainThread]:   connect_retries: 1
[0m14:22:10.665214 [info ] [MainThread]:   connect_timeout: None
[0m14:22:10.665477 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:22:10.665477 [info ] [MainThread]:   retry_all: False
[0m14:22:10.666476 [info ] [MainThread]:   insecure_mode: False
[0m14:22:10.666476 [info ] [MainThread]:   reuse_connections: True
[0m14:22:10.667472 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m14:22:10.668002 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m14:22:10.669124 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:22:11.036026 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:22:11.176620 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:22:11.176620 [debug] [MainThread]: On debug: select 1 as id
[0m14:22:11.176620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:12.513506 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.342 seconds
[0m14:22:12.513506 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:22:12.513506 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:22:12.513506 [debug] [MainThread]: Command `dbt debug` succeeded at 14:22:12.513506 after 2.66 seconds
[0m14:22:12.513506 [debug] [MainThread]: Connection 'debug' was left open.
[0m14:22:12.513506 [debug] [MainThread]: On debug: Close
[0m14:22:12.883335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A49A49E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A4429550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A710F4A0>]}
[0m14:22:12.883335 [debug] [MainThread]: Flushing usage events
[0m14:22:13.572316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:41.526737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C3188B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C3189640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C318B0B0>]}


============================== 15:05:41.542357 | 2aa23696-62e4-42cf-b70f-5ca619901f3c ==============================
[0m15:05:41.542357 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:05:41.542357 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select stg_query_history', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:05:42.000685 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:05:42.000685 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:05:42.000685 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:05:42.266249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C0C15910>]}
[0m15:05:42.360000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C0D51F40>]}
[0m15:05:42.375597 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:05:42.753983 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:05:42.753983 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:05:42.753983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C5EF4D70>]}
[0m15:05:45.062503 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'stg_query_history' in package 'snowflake_finops'
(models\staging\snowflake_usage\_stg_snowflake_usage__models.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m15:05:45.062503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C6611D60>]}
[0m15:05:45.193424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C6A57710>]}
[0m15:05:45.321425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:05:45.325153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:05:45.359160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C6A1E4E0>]}
[0m15:05:45.359160 [info ] [MainThread]: Found 3 models, 7 data tests, 2 sources, 522 macros
[0m15:05:45.360159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C69E3AA0>]}
[0m15:05:45.361147 [info ] [MainThread]: 
[0m15:05:45.362145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:45.362145 [info ] [MainThread]: 
[0m15:05:45.363142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:05:45.363142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:05:45.463261 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:05:45.463261 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:05:45.463261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:47.097285 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.634 seconds
[0m15:05:47.099653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FINOPS_DEV, now create_FINOPS_DEV_dbt_JKU)
[0m15:05:47.099653 [debug] [ThreadPool]: Creating schema "database: "FINOPS_DEV"
schema: "dbt_JKU"
"
[0m15:05:47.104129 [debug] [ThreadPool]: Using snowflake connection "create_FINOPS_DEV_dbt_JKU"
[0m15:05:47.105128 [debug] [ThreadPool]: On create_FINOPS_DEV_dbt_JKU: create schema if not exists FINOPS_DEV.dbt_JKU
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "create_FINOPS_DEV_dbt_JKU"} */
[0m15:05:47.415107 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.320 seconds
[0m15:05:47.415107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:05:47.430457 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:05:47.430457 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:05:47.430457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:48.606562 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.167 seconds
[0m15:05:48.608560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C6A12CC0>]}
[0m15:05:48.616075 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:05:48.617604 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:05:48.617604 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:05:48.617604 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:05:48.617604 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:05:48.617604 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:05:48.659383 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:05:48.664245 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:05:48.665241 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:05:48.665241 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:50.112179 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.458 seconds
[0m15:05:50.127600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa23696-62e4-42cf-b70f-5ca619901f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C0C14AA0>]}
[0m15:05:50.127600 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.51s]
[0m15:05:50.127600 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:05:50.143202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:50.143202 [debug] [MainThread]: Connection 'create_FINOPS_DEV_dbt_JKU' was left open.
[0m15:05:50.143202 [debug] [MainThread]: On create_FINOPS_DEV_dbt_JKU: Close
[0m15:05:50.494360 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:05:50.494360 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:05:50.838070 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:05:50.838070 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:05:51.207562 [info ] [MainThread]: 
[0m15:05:51.207562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m15:05:51.207562 [debug] [MainThread]: Command end result
[0m15:05:51.235923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:05:51.237917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:05:51.243664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:05:51.243664 [info ] [MainThread]: 
[0m15:05:51.244591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:51.244591 [info ] [MainThread]: 
[0m15:05:51.245641 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:05:51.246143 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:05:51.247142 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:51.247142 after 9.84 seconds
[0m15:05:51.247142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C65C9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C1729F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C3726450>]}
[0m15:05:51.248140 [debug] [MainThread]: Flushing usage events
[0m15:05:51.973014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:44.611815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2EE354650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F0D28860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F09C53D0>]}


============================== 15:08:44.616331 | 1ac217f9-4175-4561-a61a-14e2394026c7 ==============================
[0m15:08:44.616331 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:08:44.617998 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select stg_query_history', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:08:44.987599 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:08:44.987599 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:08:45.003221 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:08:45.198466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F15A74D0>]}
[0m15:08:45.307713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F2DD8830>]}
[0m15:08:45.309729 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:08:45.689575 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:08:45.859341 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m15:08:45.859341 [debug] [MainThread]: Partial parsing: deleted file: snowflake_finops://models\example\my_second_dbt_model.sql
[0m15:08:45.860338 [debug] [MainThread]: Partial parsing: deleted file: snowflake_finops://models\example\my_first_dbt_model.sql
[0m15:08:45.928147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake_finops.example
[0m15:08:45.941871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F39D6330>]}
[0m15:08:46.019048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:08:46.021481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:08:46.047305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F0E4EC00>]}
[0m15:08:46.047305 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:08:46.048204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F3A99310>]}
[0m15:08:46.048204 [info ] [MainThread]: 
[0m15:08:46.048204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:08:46.048204 [info ] [MainThread]: 
[0m15:08:46.048204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:08:46.048204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:08:46.180093 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:08:46.180093 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:08:46.180093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:47.772438 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.588 seconds
[0m15:08:47.774125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:08:47.786601 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:08:47.787598 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:08:47.787598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:49.003429 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.215 seconds
[0m15:08:49.004426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F17623C0>]}
[0m15:08:49.008671 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:08:49.008671 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:08:49.009667 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:08:49.009667 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:08:49.015909 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:08:49.016907 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:08:49.046659 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:08:49.048857 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:08:49.048857 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:08:49.049856 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:51.409909 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.361 seconds
[0m15:08:51.429110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac217f9-4175-4561-a61a-14e2394026c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2EE454B90>]}
[0m15:08:51.429110 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 2.42s]
[0m15:08:51.429110 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:08:51.436673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:51.436673 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m15:08:51.436673 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m15:08:51.813357 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:08:51.813967 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:08:52.234931 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:08:52.234931 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:08:52.596877 [info ] [MainThread]: 
[0m15:08:52.596877 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m15:08:52.596877 [debug] [MainThread]: Command end result
[0m15:08:52.625071 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:08:52.625071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:08:52.646220 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:08:52.646220 [info ] [MainThread]: 
[0m15:08:52.647213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:52.648210 [info ] [MainThread]: 
[0m15:08:52.648210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:08:52.650205 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:52.649208 after 8.17 seconds
[0m15:08:52.650205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2EE354650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F172F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F172F710>]}
[0m15:08:52.651298 [debug] [MainThread]: Flushing usage events
[0m15:08:53.375338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:09.986797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEAEE4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEDB77080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEB2C0D70>]}


============================== 15:10:09.986797 | 4d8a210c-44b1-4678-aebc-b4af1313a55c ==============================
[0m15:10:09.986797 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:10:09.986797 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_query_history', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:10:10.377380 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:10:10.377380 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:10:10.377380 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:10:10.455486 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `snowflake_finops` found at `snowflake_finops` in file `C:
\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\d
bt_project.yml`. Hierarchical config values without a '+' prefix are deprecated
in dbt_project.yml.
[0m15:10:10.455486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF056F920>]}
[0m15:10:10.607627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF05D5A90>]}
[0m15:10:10.722715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEB9A2300>]}
[0m15:10:10.722715 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:10:11.110254 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:10:11.206391 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:10:11.206391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0A2AC30>]}
[0m15:10:12.573252 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'stg_query_history' in package 'snowflake_finops'
(models\staging\snowflake_usage\_stg_snowflake_usage__models.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m15:10:12.573252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0B73E60>]}
[0m15:10:12.689329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0CCC6E0>]}
[0m15:10:12.760508 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:10:12.760508 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:10:12.795173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0EC2B70>]}
[0m15:10:12.795173 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:10:12.795173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEB9A2300>]}
[0m15:10:12.802237 [info ] [MainThread]: 
[0m15:10:12.802684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:12.802684 [info ] [MainThread]: 
[0m15:10:12.803683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:12.803683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:10:12.969426 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:10:12.969426 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:10:12.969426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:14.252697 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.293 seconds
[0m15:10:14.268050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:10:14.268050 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:10:14.268050 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:10:14.268050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:15.475291 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.197 seconds
[0m15:10:15.477463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0C78440>]}
[0m15:10:15.480750 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:10:15.480750 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:10:15.482280 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:10:15.482280 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:10:15.489905 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:10:15.490903 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:10:15.517931 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:10:15.519926 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:10:15.520923 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:10:15.520923 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:17.393757 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.885 seconds
[0m15:10:17.424787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a210c-44b1-4678-aebc-b4af1313a55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEAFE8980>]}
[0m15:10:17.424787 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.94s]
[0m15:10:17.424787 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:10:17.424787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:17.424787 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m15:10:17.424787 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m15:10:17.868251 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:10:17.868251 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:10:18.227546 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:10:18.227546 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:10:18.598261 [info ] [MainThread]: 
[0m15:10:18.598261 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m15:10:18.598261 [debug] [MainThread]: Command end result
[0m15:10:18.628571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:10:18.628571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:10:18.638735 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:10:18.638735 [info ] [MainThread]: 
[0m15:10:18.639733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:18.639733 [info ] [MainThread]: 
[0m15:10:18.640430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:10:18.641486 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:10:18.642860 [debug] [MainThread]: Command `dbt run` succeeded at 15:10:18.641836 after 8.81 seconds
[0m15:10:18.642860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEE0D39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0D3A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF0AF71A0>]}
[0m15:10:18.642860 [debug] [MainThread]: Flushing usage events
[0m15:10:19.327318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:13.782349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016526C44710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016529EBF6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016529EBDF70>]}


============================== 15:16:13.782349 | 556c5239-9637-4dde-b3d4-4f00bbba66f9 ==============================
[0m15:16:13.782349 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:16:13.782349 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_query_history', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:16:14.176283 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:16:14.176283 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:16:14.176283 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:16:14.363776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652B961760>]}
[0m15:16:14.441869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652B719730>]}
[0m15:16:14.457490 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:16:14.820336 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:16:14.914063 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:16:14.914063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165299AFEC0>]}
[0m15:16:16.141324 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'stg_query_history' in package 'snowflake_finops'
(models\staging\snowflake_usage\_stg_snowflake_usage__models.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m15:16:16.142365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652C69BE60>]}
[0m15:16:16.301789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.marts
- models.snowflake_finops.intermediate
[0m15:16:16.308272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652CB8E780>]}
[0m15:16:16.384483 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:16:16.391505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:16:16.419185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652C8AA900>]}
[0m15:16:16.419185 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:16:16.419185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652C97CD70>]}
[0m15:16:16.419185 [info ] [MainThread]: 
[0m15:16:16.419185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:16.419185 [info ] [MainThread]: 
[0m15:16:16.419185 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:16:16.419185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:16:16.578860 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:16:16.578860 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:16:16.578860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:18.055085 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.475 seconds
[0m15:16:18.057715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:16:18.069828 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:16:18.069828 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:16:18.069828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:19.692976 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.638 seconds
[0m15:16:19.708597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652CB5AAE0>]}
[0m15:16:19.708597 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:16:19.708597 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:16:19.708597 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:16:19.708597 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:16:19.708597 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:16:19.724218 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:16:19.752837 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:16:19.752837 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:16:19.752837 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:16:19.752837 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:16:22.257203 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.500 seconds
[0m15:16:22.283127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '556c5239-9637-4dde-b3d4-4f00bbba66f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016526D44B60>]}
[0m15:16:22.283127 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 2.57s]
[0m15:16:22.284124 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:16:22.285123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:22.285928 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m15:16:22.286320 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m15:16:22.651248 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:16:22.651248 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:16:23.024910 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:16:23.024910 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:16:23.547107 [info ] [MainThread]: 
[0m15:16:23.548105 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m15:16:23.548105 [debug] [MainThread]: Command end result
[0m15:16:23.570057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:16:23.572496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:16:23.578101 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:16:23.578101 [info ] [MainThread]: 
[0m15:16:23.578101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:23.578101 [info ] [MainThread]: 
[0m15:16:23.578101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:16:23.578101 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:16:23.578101 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:23.578101 after 9.92 seconds
[0m15:16:23.578101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652C9D1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652C97CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165293A1C10>]}
[0m15:16:23.578101 [debug] [MainThread]: Flushing usage events
[0m15:16:24.327126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:30.988768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E577D635F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E577D62600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E577BD73E0>]}


============================== 15:17:30.995797 | eb1cb5a5-41ba-454b-84f2-863ca05fd83b ==============================
[0m15:17:30.995797 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:17:30.995797 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_query_history --show-all-deprecations', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:17:31.340006 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:17:31.340006 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:17:31.340006 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:17:31.564304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57AFA1DC0>]}
[0m15:17:31.675470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57B21B680>]}
[0m15:17:31.682554 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:17:32.050604 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:17:32.205820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:32.205820 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:17:32.205820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:32.210811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.intermediate
- models.snowflake_finops.marts
[0m15:17:32.251776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57B21A9F0>]}
[0m15:17:32.344852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:17:32.346847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:17:32.389116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57B4B1730>]}
[0m15:17:32.390586 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:17:32.391583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E578EF1CA0>]}
[0m15:17:32.393577 [info ] [MainThread]: 
[0m15:17:32.394574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:32.394574 [info ] [MainThread]: 
[0m15:17:32.395572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:32.397222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:17:32.524399 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:17:32.525397 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:17:32.525397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:33.818961 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.293 seconds
[0m15:17:33.821077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:17:33.833401 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:17:33.833401 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:17:33.834398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:34.963763 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.130 seconds
[0m15:17:34.966486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E578EB7230>]}
[0m15:17:34.970399 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:17:34.971398 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:17:34.971398 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:17:34.971398 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:17:34.978357 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:17:34.980147 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:17:35.013005 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:17:35.014854 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:17:35.014854 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:17:35.015852 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:17:36.358787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.343 seconds
[0m15:17:36.385281 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1cb5a5-41ba-454b-84f2-863ca05fd83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E575BE4B30>]}
[0m15:17:36.385281 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.41s]
[0m15:17:36.386484 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:17:36.387483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:36.388482 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m15:17:36.388482 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m15:17:36.785280 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:17:36.785280 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:17:37.154295 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:17:37.154295 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:17:37.535572 [info ] [MainThread]: 
[0m15:17:37.535572 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m15:17:37.535572 [debug] [MainThread]: Command end result
[0m15:17:37.560167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:17:37.564155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:17:37.582012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:17:37.582012 [info ] [MainThread]: 
[0m15:17:37.603027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:37.608841 [info ] [MainThread]: 
[0m15:17:37.612983 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:17:37.627445 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:37.627445 after 6.76 seconds
[0m15:17:37.628443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5751E9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5786D6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E578825A00>]}
[0m15:17:37.628443 [debug] [MainThread]: Flushing usage events
[0m15:17:38.309270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:22.227878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D2C3DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D604C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D604FB30>]}


============================== 15:18:22.227878 | fff776d0-95a7-4808-a8f5-b1672b9405da ==============================
[0m15:18:22.227878 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:18:22.227878 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_query_history', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:18:22.557573 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:18:22.557573 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:18:22.557573 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:18:22.760057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff776d0-95a7-4808-a8f5-b1672b9405da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D82DD580>]}
[0m15:18:22.875364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fff776d0-95a7-4808-a8f5-b1672b9405da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D5D9C7D0>]}
[0m15:18:22.875364 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:18:23.232928 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:18:23.371688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:23.371688 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:18:23.371688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:23.371688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.marts
- models.snowflake_finops.intermediate
[0m15:18:23.415261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fff776d0-95a7-4808-a8f5-b1672b9405da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D8DBB4D0>]}
[0m15:18:23.494397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:18:23.494397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:18:23.525641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fff776d0-95a7-4808-a8f5-b1672b9405da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D9327620>]}
[0m15:18:23.525641 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:18:23.525641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff776d0-95a7-4808-a8f5-b1672b9405da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D8DBB4D0>]}
[0m15:18:23.541293 [info ] [MainThread]: 
[0m15:18:23.541293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:23.541293 [info ] [MainThread]: 
[0m15:18:23.541293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:23.541293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:18:23.634954 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:18:23.634954 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:18:23.634954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:24.891937 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.250 seconds
[0m15:18:24.894929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff776d0-95a7-4808-a8f5-b1672b9405da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D926DA00>]}
[0m15:18:24.900913 [debug] [Thread-2 (]: Began running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f
[0m15:18:24.901910 [debug] [Thread-3 (]: Began running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:18:24.902907 [debug] [Thread-4 (]: Began running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:18:24.901910 [info ] [Thread-2 (]: 1 of 3 START test accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED  [RUN]
[0m15:18:24.904902 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f'
[0m15:18:24.904902 [debug] [Thread-2 (]: Began compiling node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f
[0m15:18:24.902907 [info ] [Thread-3 (]: 2 of 3 START test not_null_stg_query_history_query_id .......................... [RUN]
[0m15:18:24.920974 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b'
[0m15:18:24.921808 [debug] [Thread-3 (]: Began compiling node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:18:24.945146 [debug] [Thread-2 (]: Writing injected SQL for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f"
[0m15:18:24.949135 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:18:24.903905 [info ] [Thread-4 (]: 3 of 3 START test unique_stg_query_history_query_id ............................ [RUN]
[0m15:18:24.951129 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82'
[0m15:18:24.952126 [debug] [Thread-4 (]: Began compiling node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:18:24.957940 [debug] [Thread-3 (]: Began executing node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:18:24.957940 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:18:24.988790 [debug] [Thread-2 (]: Began executing node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f
[0m15:18:25.029744 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:18:25.036825 [debug] [Thread-2 (]: Writing runtime sql for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f"
[0m15:18:25.036825 [debug] [Thread-4 (]: Began executing node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:18:25.039817 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:18:25.041811 [debug] [Thread-2 (]: Using snowflake connection "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f"
[0m15:18:25.042809 [debug] [Thread-2 (]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        execution_status as value_field,
        count(*) as n_records

    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by execution_status

)

select *
from all_values
where value_field not in (
    'SUCCESS','FAIL','RUNNING','QUEUED'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f"} */
[0m15:18:25.043806 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:18:25.043806 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:25.044907 [debug] [Thread-3 (]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select query_id
from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"} */
[0m15:18:25.045905 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:18:25.045905 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:18:25.046833 [debug] [Thread-4 (]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    query_id as unique_field,
    count(*) as n_records

from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is not null
group by query_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"} */
[0m15:18:25.046833 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:18:30.589458 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.558 seconds
[0m15:18:30.605079 [info ] [Thread-3 (]: 2 of 3 PASS not_null_stg_query_history_query_id ................................ [[32mPASS[0m in 5.68s]
[0m15:18:30.605079 [debug] [Thread-3 (]: Finished running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:18:34.673904 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 9.640 seconds
[0m15:18:34.673904 [error] [Thread-2 (]: 1 of 3 FAIL 1 accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED  [[31mFAIL 1[0m in 9.77s]
[0m15:18:34.673904 [debug] [Thread-2 (]: Finished running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f
[0m15:18:42.114435 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 17.071 seconds
[0m15:18:42.114435 [info ] [Thread-4 (]: 3 of 3 PASS unique_stg_query_history_query_id .................................. [[32mPASS[0m in 17.16s]
[0m15:18:42.114435 [debug] [Thread-4 (]: Finished running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:18:42.114435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:42.114435 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:18:42.114435 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:18:42.550566 [debug] [MainThread]: Connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f' was left open.
[0m15:18:42.550566 [debug] [MainThread]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED.b8dfbc903f: Close
[0m15:18:42.923219 [debug] [MainThread]: Connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b' was left open.
[0m15:18:42.924217 [debug] [MainThread]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: Close
[0m15:18:43.324051 [debug] [MainThread]: Connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82' was left open.
[0m15:18:43.324051 [debug] [MainThread]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: Close
[0m15:18:43.683634 [info ] [MainThread]: 
[0m15:18:43.684631 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 20.14 seconds (20.14s).
[0m15:18:43.685628 [debug] [MainThread]: Command end result
[0m15:18:43.705617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:18:43.710303 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:18:43.711115 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:18:43.716786 [info ] [MainThread]: 
[0m15:18:43.716786 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:43.717783 [info ] [MainThread]: 
[0m15:18:43.717783 [error] [MainThread]: [31mFailure in test accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__RUNNING__QUEUED (models\staging\snowflake_usage\_stg_snowflake_usage__models.yml)[0m
[0m15:18:43.718782 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:18:43.719491 [info ] [MainThread]: 
[0m15:18:43.719491 [info ] [MainThread]:   compiled code at target\compiled\snowflake_finops\models\staging\snowflake_usage\_stg_snowflake_usage__models.yml\accepted_values_stg_query_hist_23c2977d096fdafa9320cd047ea96252.sql
[0m15:18:43.720490 [info ] [MainThread]: 
[0m15:18:43.721120 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:18:43.721620 [debug] [MainThread]: Command `dbt test` failed at 15:18:43.721620 after 21.63 seconds
[0m15:18:43.722620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D5DF1B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D6A4DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D6A4DDC0>]}
[0m15:18:43.722620 [debug] [MainThread]: Flushing usage events
[0m15:18:44.390476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:13.941208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EBE74110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC1DB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EBE77CE0>]}


============================== 15:25:13.941208 | c4cdc055-9394-4ba4-9883-96c0f89f0729 ==============================
[0m15:25:13.941208 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:25:13.941208 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select stg_query_history', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:25:14.299108 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:25:14.299108 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:25:14.299108 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:25:14.549022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4cdc055-9394-4ba4-9883-96c0f89f0729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EBF620F0>]}
[0m15:25:14.670194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4cdc055-9394-4ba4-9883-96c0f89f0729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC280470>]}
[0m15:25:14.670194 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:25:15.105827 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:25:15.348077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:15.349168 [debug] [MainThread]: Partial parsing: updated file: snowflake_finops://models\staging\snowflake_usage\_stg_snowflake_usage__models.yml
[0m15:25:15.823998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.intermediate
- models.snowflake_finops.marts
[0m15:25:15.844813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4cdc055-9394-4ba4-9883-96c0f89f0729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF2C23C0>]}
[0m15:25:15.917703 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:25:15.917703 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:25:15.948913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4cdc055-9394-4ba4-9883-96c0f89f0729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF87DAC0>]}
[0m15:25:15.948913 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:25:15.964560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4cdc055-9394-4ba4-9883-96c0f89f0729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF4ACA70>]}
[0m15:25:15.964560 [info ] [MainThread]: 
[0m15:25:15.964560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:25:15.964560 [info ] [MainThread]: 
[0m15:25:15.964560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:15.964560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:25:16.079208 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:25:16.079208 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:25:16.079208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:17.447555 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.380 seconds
[0m15:25:17.447555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4cdc055-9394-4ba4-9883-96c0f89f0729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF6F5160>]}
[0m15:25:17.463176 [debug] [Thread-2 (]: Began running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22
[0m15:25:17.463176 [debug] [Thread-3 (]: Began running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:25:17.463176 [debug] [Thread-4 (]: Began running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:25:17.463176 [info ] [Thread-2 (]: 1 of 3 START test accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT  [RUN]
[0m15:25:17.463176 [info ] [Thread-3 (]: 2 of 3 START test not_null_stg_query_history_query_id .......................... [RUN]
[0m15:25:17.463176 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22'
[0m15:25:17.463176 [info ] [Thread-4 (]: 3 of 3 START test unique_stg_query_history_query_id ............................ [RUN]
[0m15:25:17.463176 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b'
[0m15:25:17.463176 [debug] [Thread-2 (]: Began compiling node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22
[0m15:25:17.463176 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82'
[0m15:25:17.463176 [debug] [Thread-3 (]: Began compiling node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:25:17.478797 [debug] [Thread-2 (]: Writing injected SQL for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22"
[0m15:25:17.479486 [debug] [Thread-4 (]: Began compiling node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:25:17.486508 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:25:17.487522 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:25:17.487522 [debug] [Thread-2 (]: Began executing node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22
[0m15:25:17.515267 [debug] [Thread-2 (]: Writing runtime sql for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22"
[0m15:25:17.515267 [debug] [Thread-4 (]: Began executing node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:25:17.515267 [debug] [Thread-3 (]: Began executing node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:25:17.518434 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:25:17.525248 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:25:17.526246 [debug] [Thread-2 (]: Using snowflake connection "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22"
[0m15:25:17.527243 [debug] [Thread-2 (]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        execution_status as value_field,
        count(*) as n_records

    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by execution_status

)

select *
from all_values
where value_field not in (
    'SUCCESS','FAIL','INCIDENT'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22"} */
[0m15:25:17.527243 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:25:17.528240 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:25:17.529238 [debug] [Thread-3 (]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select query_id
from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"} */
[0m15:25:17.529238 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:25:17.530235 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:25:17.531232 [debug] [Thread-4 (]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    query_id as unique_field,
    count(*) as n_records

from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is not null
group by query_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"} */
[0m15:25:17.532230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:25:28.075186 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 10.560 seconds
[0m15:25:28.090562 [info ] [Thread-2 (]: 1 of 3 PASS accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT  [[32mPASS[0m in 10.63s]
[0m15:25:28.090562 [debug] [Thread-2 (]: Finished running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22
[0m15:25:30.567510 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 13.038 seconds
[0m15:25:30.567510 [info ] [Thread-4 (]: 3 of 3 PASS unique_stg_query_history_query_id .................................. [[32mPASS[0m in 13.10s]
[0m15:25:30.567510 [debug] [Thread-4 (]: Finished running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:25:46.920946 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 29.392 seconds
[0m15:25:46.920946 [info ] [Thread-3 (]: 2 of 3 PASS not_null_stg_query_history_query_id ................................ [[32mPASS[0m in 29.46s]
[0m15:25:46.926431 [debug] [Thread-3 (]: Finished running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:25:46.927859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:46.927859 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:25:46.927859 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:25:47.313138 [debug] [MainThread]: Connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22' was left open.
[0m15:25:47.313138 [debug] [MainThread]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__SUCCESS__FAIL__INCIDENT.c457bb8f22: Close
[0m15:25:47.683379 [debug] [MainThread]: Connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b' was left open.
[0m15:25:47.683379 [debug] [MainThread]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: Close
[0m15:25:48.074156 [debug] [MainThread]: Connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82' was left open.
[0m15:25:48.074156 [debug] [MainThread]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: Close
[0m15:25:48.448817 [info ] [MainThread]: 
[0m15:25:48.448817 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 32.48 seconds (32.48s).
[0m15:25:48.454865 [debug] [MainThread]: Command end result
[0m15:25:48.484166 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:25:48.489421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:25:48.499392 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:25:48.500051 [info ] [MainThread]: 
[0m15:25:48.500485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:48.502208 [info ] [MainThread]: 
[0m15:25:48.503213 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:25:48.505201 [debug] [MainThread]: Command `dbt test` succeeded at 15:25:48.505201 after 34.71 seconds
[0m15:25:48.506198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EBE77CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EBE74410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EBE74050>]}
[0m15:25:48.506198 [debug] [MainThread]: Flushing usage events
[0m15:25:49.306509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:18.887474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E59E31BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E59E31B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5A479250>]}


============================== 15:29:18.893973 | af86934f-3b5d-4994-a3a8-7b840d65f437 ==============================
[0m15:29:18.893973 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:29:18.894970 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_query_history', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:29:19.348640 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:29:19.348640 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:29:19.348640 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:29:19.525908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5C9A0B90>]}
[0m15:29:19.631351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5C630380>]}
[0m15:29:19.631351 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:29:19.971488 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:29:20.198956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:29:20.198956 [debug] [MainThread]: Partial parsing: updated file: snowflake_finops://models\staging\snowflake_usage\_stg_snowflake_usage__models.yml
[0m15:29:20.198956 [debug] [MainThread]: Partial parsing: updated file: snowflake_finops://models\staging\snowflake_usage\stg_query_history.sql
[0m15:29:20.605111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.marts
- models.snowflake_finops.intermediate
[0m15:29:20.620732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5D412870>]}
[0m15:29:20.700465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:29:20.700465 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:29:20.716085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5D686F90>]}
[0m15:29:20.716085 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:29:20.716085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5CDC7C20>]}
[0m15:29:20.716085 [info ] [MainThread]: 
[0m15:29:20.716085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:20.731708 [info ] [MainThread]: 
[0m15:29:20.731708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:20.731708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:29:20.811069 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:29:20.811069 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:29:20.811069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:22.030497 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.217 seconds
[0m15:29:22.030497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:29:22.046119 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:29:22.046119 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:29:22.046119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:23.393337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.344 seconds
[0m15:29:23.393337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5D6022A0>]}
[0m15:29:23.393337 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:29:23.393337 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:29:23.393337 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:29:23.393337 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:29:23.408712 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:29:23.408712 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:29:23.440072 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:29:23.447502 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:29:23.448488 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        -- Normalize to lowercase to match the documentation and tests
        lower(execution_status) as execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:29:23.448488 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:25.126373 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.677 seconds
[0m15:29:25.150496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af86934f-3b5d-4994-a3a8-7b840d65f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E577D49B0>]}
[0m15:29:25.150496 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.75s]
[0m15:29:25.151494 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:29:25.152680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:25.152680 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m15:29:25.153679 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m15:29:25.533865 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:29:25.534556 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:29:25.938327 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:29:25.939109 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:29:26.299018 [info ] [MainThread]: 
[0m15:29:26.300166 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m15:29:26.300543 [debug] [MainThread]: Command end result
[0m15:29:26.319710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:29:26.323700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:29:26.329586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:29:26.329586 [info ] [MainThread]: 
[0m15:29:26.329586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:26.329586 [info ] [MainThread]: 
[0m15:29:26.329586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:26.329586 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:26.329586 after 7.57 seconds
[0m15:29:26.329586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E599D68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E5A85F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E582EDF40>]}
[0m15:29:26.329586 [debug] [MainThread]: Flushing usage events
[0m15:29:27.022552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:37.219277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD97114C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD90DF800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD90DD580>]}


============================== 15:29:37.219277 | b3306faf-f565-4121-8d1a-68063a2a4da6 ==============================
[0m15:29:37.219277 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:29:37.219277 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'invocation_command': 'dbt test --select stg_query_history', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:29:37.575635 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:29:37.575635 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:29:37.575635 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:29:37.763091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3306faf-f565-4121-8d1a-68063a2a4da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDBB84110>]}
[0m15:29:37.867269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3306faf-f565-4121-8d1a-68063a2a4da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDB9ACA40>]}
[0m15:29:37.867269 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:29:38.206935 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:29:38.356826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:38.356826 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:29:38.356826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:38.372474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.intermediate
- models.snowflake_finops.marts
[0m15:29:38.408976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3306faf-f565-4121-8d1a-68063a2a4da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDBE822D0>]}
[0m15:29:38.479480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:29:38.479480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:29:38.510721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3306faf-f565-4121-8d1a-68063a2a4da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDC117920>]}
[0m15:29:38.510721 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:29:38.510721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3306faf-f565-4121-8d1a-68063a2a4da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDBBA98B0>]}
[0m15:29:38.510721 [info ] [MainThread]: 
[0m15:29:38.510721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:38.510721 [info ] [MainThread]: 
[0m15:29:38.510721 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:38.510721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:29:38.625327 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:29:38.625327 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:29:38.625327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:39.997566 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.369 seconds
[0m15:29:39.997566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3306faf-f565-4121-8d1a-68063a2a4da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDBAAB980>]}
[0m15:29:39.997566 [debug] [Thread-2 (]: Began running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:29:39.997566 [debug] [Thread-3 (]: Began running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:29:39.997566 [debug] [Thread-4 (]: Began running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:29:39.997566 [info ] [Thread-2 (]: 1 of 3 START test accepted_values_stg_query_history_execution_status__success__fail__incident  [RUN]
[0m15:29:39.997566 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c'
[0m15:29:39.997566 [info ] [Thread-3 (]: 2 of 3 START test not_null_stg_query_history_query_id .......................... [RUN]
[0m15:29:40.013049 [debug] [Thread-2 (]: Began compiling node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:29:39.997566 [info ] [Thread-4 (]: 3 of 3 START test unique_stg_query_history_query_id ............................ [RUN]
[0m15:29:40.013049 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b'
[0m15:29:40.013049 [debug] [Thread-2 (]: Writing injected SQL for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m15:29:40.013049 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82'
[0m15:29:40.013049 [debug] [Thread-3 (]: Began compiling node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:29:40.028696 [debug] [Thread-4 (]: Began compiling node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:29:40.037598 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:29:40.040930 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:29:40.040930 [debug] [Thread-2 (]: Began executing node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:29:40.067338 [debug] [Thread-2 (]: Writing runtime sql for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m15:29:40.067338 [debug] [Thread-3 (]: Began executing node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:29:40.070484 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:29:40.070484 [debug] [Thread-4 (]: Began executing node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:29:40.073457 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:29:40.075444 [debug] [Thread-2 (]: Using snowflake connection "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m15:29:40.076534 [debug] [Thread-2 (]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        execution_status as value_field,
        count(*) as n_records

    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by execution_status

)

select *
from all_values
where value_field not in (
    'success','fail','incident'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"} */
[0m15:29:40.076534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:40.076534 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:29:40.076534 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:29:40.076534 [debug] [Thread-4 (]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    query_id as unique_field,
    count(*) as n_records

from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is not null
group by query_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"} */
[0m15:29:40.076534 [debug] [Thread-3 (]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select query_id
from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"} */
[0m15:29:40.076534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:29:40.076534 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:29:45.654243 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.579 seconds
[0m15:29:45.654243 [info ] [Thread-3 (]: 2 of 3 PASS not_null_stg_query_history_query_id ................................ [[32mPASS[0m in 5.64s]
[0m15:29:45.654243 [debug] [Thread-3 (]: Finished running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:29:50.899853 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 10.824 seconds
[0m15:29:50.899853 [info ] [Thread-2 (]: 1 of 3 PASS accepted_values_stg_query_history_execution_status__success__fail__incident  [[32mPASS[0m in 10.90s]
[0m15:29:50.899853 [debug] [Thread-2 (]: Finished running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:29:51.061239 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.987 seconds
[0m15:29:51.061239 [info ] [Thread-4 (]: 3 of 3 PASS unique_stg_query_history_query_id .................................. [[32mPASS[0m in 11.05s]
[0m15:29:51.061239 [debug] [Thread-4 (]: Finished running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:29:51.061239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:51.061239 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:29:51.061239 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:29:51.453320 [debug] [MainThread]: Connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c' was left open.
[0m15:29:51.453320 [debug] [MainThread]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c: Close
[0m15:29:51.844482 [debug] [MainThread]: Connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b' was left open.
[0m15:29:51.844482 [debug] [MainThread]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: Close
[0m15:29:52.238735 [debug] [MainThread]: Connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82' was left open.
[0m15:29:52.238735 [debug] [MainThread]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: Close
[0m15:29:52.637296 [info ] [MainThread]: 
[0m15:29:52.638295 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 14.13 seconds (14.13s).
[0m15:29:52.639316 [debug] [MainThread]: Command end result
[0m15:29:52.659602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:29:52.661597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:29:52.668891 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:29:52.669868 [info ] [MainThread]: 
[0m15:29:52.670865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:52.671996 [info ] [MainThread]: 
[0m15:29:52.672313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:29:52.673350 [debug] [MainThread]: Command `dbt test` succeeded at 15:29:52.673350 after 15.57 seconds
[0m15:29:52.673350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD9177D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD8AABDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD8AA8410>]}
[0m15:29:52.674375 [debug] [MainThread]: Flushing usage events
[0m15:29:53.367262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:21.232705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D03C8A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D08835C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6CE101B80>]}


============================== 15:49:21.232705 | 0e1eaf2c-8f44-484b-b471-91df03472f01 ==============================
[0m15:49:21.232705 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:49:21.232705 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m15:49:21.729439 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:49:21.729439 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:49:21.729439 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:49:21.942787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1eaf2c-8f44-484b-b471-91df03472f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D10F4B00>]}
[0m15:49:22.036516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1eaf2c-8f44-484b-b471-91df03472f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D0A2A690>]}
[0m15:49:22.036516 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:49:22.434058 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:49:22.661571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:22.662569 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:49:22.662569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:22.667400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snowflake_finops.intermediate
- models.snowflake_finops.marts
[0m15:49:22.708123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1eaf2c-8f44-484b-b471-91df03472f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D0915A00>]}
[0m15:49:22.784681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:49:22.788120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:49:22.854366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1eaf2c-8f44-484b-b471-91df03472f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D384BDA0>]}
[0m15:49:22.855363 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 522 macros
[0m15:49:22.858332 [info ] [MainThread]: 
[0m15:49:22.858332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:22.859532 [info ] [MainThread]: 
[0m15:49:22.860529 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:49:22.860757 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m15:49:22.975754 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m15:49:22.975754 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m15:49:22.975754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:24.567480 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.591 seconds
[0m15:49:24.570143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m15:49:24.586455 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m15:49:24.586455 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m15:49:24.587452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:25.933489 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.346 seconds
[0m15:49:25.934984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1eaf2c-8f44-484b-b471-91df03472f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D34DF170>]}
[0m15:49:25.944339 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m15:49:25.945603 [info ] [Thread-2 (]: 1 of 4 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m15:49:25.945603 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m15:49:25.945603 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m15:49:25.952474 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m15:49:25.953626 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m15:49:25.987234 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m15:49:25.988232 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m15:49:25.989229 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        -- Normalize to lowercase to match the documentation and tests
        lower(execution_status) as execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m15:49:25.989229 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:27.642234 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.654 seconds
[0m15:49:27.657856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1eaf2c-8f44-484b-b471-91df03472f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6CDE20D40>]}
[0m15:49:27.657856 [info ] [Thread-2 (]: 1 of 4 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.71s]
[0m15:49:27.657856 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m15:49:27.657856 [debug] [Thread-4 (]: Began running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:49:27.657856 [debug] [Thread-5 (]: Began running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:49:27.657856 [debug] [Thread-3 (]: Began running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:49:27.657856 [info ] [Thread-4 (]: 2 of 4 START test accepted_values_stg_query_history_execution_status__success__fail__incident  [RUN]
[0m15:49:27.657856 [info ] [Thread-5 (]: 3 of 4 START test not_null_stg_query_history_query_id .......................... [RUN]
[0m15:49:27.673478 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c'
[0m15:49:27.673478 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b'
[0m15:49:27.657856 [info ] [Thread-3 (]: 4 of 4 START test unique_stg_query_history_query_id ............................ [RUN]
[0m15:49:27.675082 [debug] [Thread-4 (]: Began compiling node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:49:27.675125 [debug] [Thread-5 (]: Began compiling node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:49:27.676063 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82'
[0m15:49:27.699728 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m15:49:27.699728 [debug] [Thread-5 (]: Writing injected SQL for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:49:27.699728 [debug] [Thread-3 (]: Began compiling node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:49:27.711078 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:49:27.711078 [debug] [Thread-4 (]: Began executing node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:49:27.720631 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m15:49:27.720631 [debug] [Thread-5 (]: Began executing node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:49:27.720631 [debug] [Thread-5 (]: Writing runtime sql for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:49:27.720631 [debug] [Thread-3 (]: Began executing node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:49:27.720631 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:49:27.720631 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m15:49:27.720631 [debug] [Thread-5 (]: Using snowflake connection "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m15:49:27.720631 [debug] [Thread-4 (]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        execution_status as value_field,
        count(*) as n_records

    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by execution_status

)

select *
from all_values
where value_field not in (
    'success','fail','incident'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"} */
[0m15:49:27.736266 [debug] [Thread-5 (]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select query_id
from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"} */
[0m15:49:27.736266 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:49:27.736266 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:49:27.736266 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m15:49:27.736266 [debug] [Thread-3 (]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    query_id as unique_field,
    count(*) as n_records

from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is not null
group by query_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"} */
[0m15:49:27.736266 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:33.182141 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 5.456 seconds
[0m15:49:33.197492 [info ] [Thread-5 (]: 3 of 4 PASS not_null_stg_query_history_query_id ................................ [[32mPASS[0m in 5.52s]
[0m15:49:33.197492 [debug] [Thread-5 (]: Finished running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m15:49:38.386284 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.654 seconds
[0m15:49:38.386284 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 10.654 seconds
[0m15:49:38.386284 [info ] [Thread-4 (]: 2 of 4 PASS accepted_values_stg_query_history_execution_status__success__fail__incident  [[32mPASS[0m in 10.71s]
[0m15:49:38.386284 [debug] [Thread-4 (]: Finished running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m15:49:38.386284 [info ] [Thread-3 (]: 4 of 4 PASS unique_stg_query_history_query_id .................................. [[32mPASS[0m in 10.71s]
[0m15:49:38.386284 [debug] [Thread-3 (]: Finished running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m15:49:38.386284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:38.386284 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m15:49:38.386284 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m15:49:38.800896 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m15:49:38.800896 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m15:49:39.248254 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m15:49:39.248254 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m15:49:39.620145 [debug] [MainThread]: Connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c' was left open.
[0m15:49:39.620145 [debug] [MainThread]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c: Close
[0m15:49:40.022869 [debug] [MainThread]: Connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b' was left open.
[0m15:49:40.022869 [debug] [MainThread]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: Close
[0m15:49:40.474345 [debug] [MainThread]: Connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82' was left open.
[0m15:49:40.474474 [debug] [MainThread]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: Close
[0m15:49:40.862736 [info ] [MainThread]: 
[0m15:49:40.863244 [info ] [MainThread]: Finished running 3 data tests, 1 view model in 0 hours 0 minutes and 18.00 seconds (18.00s).
[0m15:49:40.863244 [debug] [MainThread]: Command end result
[0m15:49:40.885582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m15:49:40.890564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m15:49:40.897165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m15:49:40.898155 [info ] [MainThread]: 
[0m15:49:40.899153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:40.899153 [info ] [MainThread]: 
[0m15:49:40.900297 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:49:40.901256 [debug] [MainThread]: Command `dbt build` succeeded at 15:49:40.901256 after 19.78 seconds
[0m15:49:40.901256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D02EC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D10DA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6D10DABA0>]}
[0m15:49:40.901256 [debug] [MainThread]: Flushing usage events
[0m15:49:41.724035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:07.864878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40CB9A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40C7D6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40C7D6810>]}


============================== 16:09:07.864878 | 3fe7cc40-8358-4f53-afa9-9fa50e4f89d9 ==============================
[0m16:09:07.864878 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:09:07.864878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'log_path': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:09:08.510515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fe7cc40-8358-4f53-afa9-9fa50e4f89d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40CC73A50>]}
[0m16:09:08.545636 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:09:08.545636 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:09:08.545636 [debug] [MainThread]: Command `cli deps` succeeded at 16:09:08.545636 after 0.79 seconds
[0m16:09:08.545636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40CB9A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40CB987D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40CBF2150>]}
[0m16:09:08.545636 [debug] [MainThread]: Flushing usage events
[0m16:09:08.927497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:46.923736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029936D55880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029936D54AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299372BD9A0>]}


============================== 16:10:46.923736 | daae23b0-588b-4983-92fa-128734ad7829 ==============================
[0m16:10:46.923736 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:10:46.923736 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m16:10:47.389115 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:10:47.389115 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:10:47.389115 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:10:47.607814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029939C70B90>]}
[0m16:10:47.701568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029939A2E8D0>]}
[0m16:10:47.701568 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:10:48.128789 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:10:48.335253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:10:48.336250 [debug] [MainThread]: Partial parsing: added file: snowflake_finops://macros\convert_usd_to_eur.sql
[0m16:10:48.336250 [debug] [MainThread]: Partial parsing: added file: snowflake_finops://models\marts\finops\_finops__models.yml
[0m16:10:48.336250 [debug] [MainThread]: Partial parsing: added file: snowflake_finops://models\marts\finops\fct_daily_warehouse_costs.sql
[0m16:10:48.760310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake_finops.intermediate
[0m16:10:48.773241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993A2FF410>]}
[0m16:10:48.845282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m16:10:48.845282 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m16:10:48.876526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993535CB90>]}
[0m16:10:48.876526 [info ] [MainThread]: Found 2 models, 6 data tests, 2 sources, 523 macros
[0m16:10:48.876526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029939CEE360>]}
[0m16:10:48.876526 [info ] [MainThread]: 
[0m16:10:48.876526 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:48.876526 [info ] [MainThread]: 
[0m16:10:48.876526 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:48.876526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m16:10:48.986077 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m16:10:48.986077 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m16:10:48.987100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:50.407540 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.428 seconds
[0m16:10:50.407540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m16:10:50.423145 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m16:10:50.423145 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m16:10:50.423145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:51.346303 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.919 seconds
[0m16:10:51.348517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993535CDA0>]}
[0m16:10:51.355463 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m16:10:51.356460 [info ] [Thread-2 (]: 1 of 2 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m16:10:51.357458 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m16:10:51.357458 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m16:10:51.365801 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m16:10:51.366919 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m16:10:51.413351 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m16:10:51.415415 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m16:10:51.417182 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        -- Normalize to lowercase to match the documentation and tests
        lower(execution_status) as execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m16:10:51.417182 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:10:52.984868 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.580 seconds
[0m16:10:53.015885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299347E4A70>]}
[0m16:10:53.015885 [info ] [Thread-2 (]: 1 of 2 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.66s]
[0m16:10:53.015885 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m16:10:53.015885 [debug] [Thread-4 (]: Began running node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:10:53.015885 [info ] [Thread-4 (]: 2 of 2 START sql table model dbt_JKU.fct_daily_warehouse_costs ................. [RUN]
[0m16:10:53.015885 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snowflake_finops.fct_daily_warehouse_costs'
[0m16:10:53.015885 [debug] [Thread-4 (]: Began compiling node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:10:53.031507 [debug] [Thread-4 (]: Writing injected SQL for node "model.snowflake_finops.fct_daily_warehouse_costs"
[0m16:10:53.031507 [debug] [Thread-4 (]: Began executing node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:10:53.047128 [debug] [Thread-4 (]: Writing runtime sql for node "model.snowflake_finops.fct_daily_warehouse_costs"
[0m16:10:53.062750 [debug] [Thread-4 (]: Using snowflake connection "model.snowflake_finops.fct_daily_warehouse_costs"
[0m16:10:53.062750 [debug] [Thread-4 (]: On model.snowflake_finops.fct_daily_warehouse_costs: create or replace transient table FINOPS_DEV.dbt_JKU.fct_daily_warehouse_costs
    
    
    
    as (

with daily_metrics as (
    /* 1. Aggregate staging data to a daily grain per warehouse */
    select
        date_trunc('day', start_time) as cost_date,
        warehouse_name,
        sum(credits_spent) as total_credits_spent
    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by 1, 2
),

final as (
    /* 2. Apply business logic and currency conversion */
    select
        -- Generate a unique ID for this grain (Date + Warehouse)
        md5(cast(concat(coalesce(cast(cost_date as string), ''), '-', coalesce(cast(warehouse_name as string), '')) as string)) as daily_warehouse_id,
        cost_date,
        warehouse_name,
        total_credits_spent,
        -- Assumption: $3.00 per credit (Snowflake Standard pricing)
        -- Calling our Jinja macro for the EUR conversion
        
    /* Generic macro to convert USD amounts to EUR.
       Default rate is 0.92, but can be overridden during the call.
    */
    round(total_credits_spent * 3.00 * 0.92, 2)
 as cost_eur
    from daily_metrics
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.fct_daily_warehouse_costs"} */;
[0m16:10:53.062750 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:03.679652 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.613 seconds
[0m16:11:03.679652 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae23b0-588b-4983-92fa-128734ad7829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993BC73AA0>]}
[0m16:11:03.679652 [info ] [Thread-4 (]: 2 of 2 OK created sql table model dbt_JKU.fct_daily_warehouse_costs ............ [[32mSUCCESS 1[0m in 10.66s]
[0m16:11:03.679652 [debug] [Thread-4 (]: Finished running node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:11:03.679652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:03.679652 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m16:11:03.679652 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m16:11:04.080475 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m16:11:04.080475 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m16:11:04.516051 [debug] [MainThread]: Connection 'model.snowflake_finops.stg_query_history' was left open.
[0m16:11:04.516051 [debug] [MainThread]: On model.snowflake_finops.stg_query_history: Close
[0m16:11:04.932750 [debug] [MainThread]: Connection 'model.snowflake_finops.fct_daily_warehouse_costs' was left open.
[0m16:11:04.932750 [debug] [MainThread]: On model.snowflake_finops.fct_daily_warehouse_costs: Close
[0m16:11:05.366281 [info ] [MainThread]: 
[0m16:11:05.366281 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 16.49 seconds (16.49s).
[0m16:11:05.366281 [debug] [MainThread]: Command end result
[0m16:11:05.381903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m16:11:05.398953 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m16:11:05.404782 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m16:11:05.405484 [info ] [MainThread]: 
[0m16:11:05.405484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:05.407139 [info ] [MainThread]: 
[0m16:11:05.407139 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:11:05.408145 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:05.408145 after 18.61 seconds
[0m16:11:05.409133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029937937D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993BB5BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029936DA89E0>]}
[0m16:11:05.409133 [debug] [MainThread]: Flushing usage events
[0m16:11:06.119809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:27.341280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BFACECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C2BB3EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C2BB3F20>]}


============================== 16:11:27.341280 | 257d4bad-6f0c-4185-8b15-d4bd08178095 ==============================
[0m16:11:27.341280 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:11:27.341280 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jksch\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs'}
[0m16:11:27.704069 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:11:27.704069 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:11:27.704069 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:11:27.954011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C5162960>]}
[0m16:11:28.047769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C57014C0>]}
[0m16:11:28.047769 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:11:28.419142 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:11:28.575353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:28.575353 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:11:28.575353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:28.591005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake_finops.intermediate
[0m16:11:28.629239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C38FAF90>]}
[0m16:11:28.712816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m16:11:28.716836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m16:11:28.750848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C5EBBE30>]}
[0m16:11:28.750848 [info ] [MainThread]: Found 2 models, 6 data tests, 2 sources, 523 macros
[0m16:11:28.766470 [info ] [MainThread]: 
[0m16:11:28.766470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:28.766470 [info ] [MainThread]: 
[0m16:11:28.766470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:28.766470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV'
[0m16:11:28.944865 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV"
[0m16:11:28.944865 [debug] [ThreadPool]: On list_FINOPS_DEV: show terse schemas in database FINOPS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV"} */
[0m16:11:28.944865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:30.302758 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.369 seconds
[0m16:11:30.320212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINOPS_DEV_dbt_JKU'
[0m16:11:30.330368 [debug] [ThreadPool]: Using snowflake connection "list_FINOPS_DEV_dbt_JKU"
[0m16:11:30.330368 [debug] [ThreadPool]: On list_FINOPS_DEV_dbt_JKU: show objects in FINOPS_DEV.dbt_JKU
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "connection_name": "list_FINOPS_DEV_dbt_JKU"} */;
[0m16:11:30.330368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:31.654830 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.333 seconds
[0m16:11:31.654830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C5AFF650>]}
[0m16:11:31.654830 [debug] [Thread-2 (]: Began running node model.snowflake_finops.stg_query_history
[0m16:11:31.670207 [info ] [Thread-2 (]: 1 of 8 START sql view model dbt_JKU.stg_query_history .......................... [RUN]
[0m16:11:31.670207 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_finops.stg_query_history'
[0m16:11:31.670207 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.stg_query_history
[0m16:11:31.670207 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.stg_query_history"
[0m16:11:31.670207 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.stg_query_history
[0m16:11:31.717042 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.stg_query_history"
[0m16:11:31.719014 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.stg_query_history"
[0m16:11:31.719014 [debug] [Thread-2 (]: On model.snowflake_finops.stg_query_history: create or replace   view FINOPS_DEV.dbt_JKU.stg_query_history
  
  
  
  
  as (
    

with source as (
    /* Extracting raw data from the Snowflake shared database */
    select * from SNOWFLAKE.ACCOUNT_USAGE.query_history
),

renamed as (
    select
        query_id,
        query_text,
        database_name,
        schema_name,
        warehouse_name,
        user_name,
        role_name,
        -- Normalize to lowercase to match the documentation and tests
        lower(execution_status) as execution_status,
        -- Convert milliseconds to seconds for better readability
        (total_elapsed_time / 1000) as execution_time_s,
        (compilation_time / 1000) as compilation_time_s,
        -- Basic credit estimation (using cloud services credits as a proxy)
        round(credits_used_cloud_services, 4) as credits_spent,
        start_time,
        end_time
    from source
    -- Development filter: Limit data to the last 30 days for performance
    where start_time >= dateadd(day, -30, current_timestamp())
)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.stg_query_history"} */;
[0m16:11:31.720037 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:33.413273 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m16:11:33.440746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C5CCCAA0>]}
[0m16:11:33.441767 [info ] [Thread-2 (]: 1 of 8 OK created sql view model dbt_JKU.stg_query_history ..................... [[32mSUCCESS 1[0m in 1.76s]
[0m16:11:33.441767 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.stg_query_history
[0m16:11:33.441767 [debug] [Thread-4 (]: Began running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m16:11:33.441767 [debug] [Thread-5 (]: Began running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m16:11:33.441767 [debug] [Thread-3 (]: Began running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m16:11:33.441767 [info ] [Thread-4 (]: 2 of 8 START test accepted_values_stg_query_history_execution_status__success__fail__incident  [RUN]
[0m16:11:33.441767 [info ] [Thread-5 (]: 3 of 8 START test not_null_stg_query_history_query_id .......................... [RUN]
[0m16:11:33.441767 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c'
[0m16:11:33.441767 [info ] [Thread-3 (]: 4 of 8 START test unique_stg_query_history_query_id ............................ [RUN]
[0m16:11:33.441767 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b'
[0m16:11:33.447661 [debug] [Thread-4 (]: Began compiling node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m16:11:33.447661 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82'
[0m16:11:33.448530 [debug] [Thread-5 (]: Began compiling node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m16:11:33.457428 [debug] [Thread-3 (]: Began compiling node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m16:11:33.464698 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m16:11:33.470852 [debug] [Thread-5 (]: Writing injected SQL for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m16:11:33.476340 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m16:11:33.476340 [debug] [Thread-5 (]: Began executing node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m16:11:33.476340 [debug] [Thread-3 (]: Began executing node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m16:11:33.476340 [debug] [Thread-4 (]: Began executing node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m16:11:33.496674 [debug] [Thread-5 (]: Writing runtime sql for node "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m16:11:33.496674 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m16:11:33.496674 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m16:11:33.503679 [debug] [Thread-5 (]: Using snowflake connection "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"
[0m16:11:33.503679 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"
[0m16:11:33.503679 [debug] [Thread-5 (]: On test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select query_id
from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b"} */
[0m16:11:33.503679 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"
[0m16:11:33.503679 [debug] [Thread-3 (]: On test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    query_id as unique_field,
    count(*) as n_records

from FINOPS_DEV.dbt_JKU.stg_query_history
where query_id is not null
group by query_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82"} */
[0m16:11:33.503679 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m16:11:33.503679 [debug] [Thread-4 (]: On test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        execution_status as value_field,
        count(*) as n_records

    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by execution_status

)

select *
from all_values
where value_field not in (
    'success','fail','incident'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c"} */
[0m16:11:33.503679 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:33.503679 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:39.217660 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 5.714 seconds
[0m16:11:39.217660 [info ] [Thread-5 (]: 3 of 8 PASS not_null_stg_query_history_query_id ................................ [[32mPASS[0m in 5.78s]
[0m16:11:39.217660 [debug] [Thread-5 (]: Finished running node test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b
[0m16:11:40.481460 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.972 seconds
[0m16:11:40.483493 [info ] [Thread-3 (]: 4 of 8 PASS unique_stg_query_history_query_id .................................. [[32mPASS[0m in 7.04s]
[0m16:11:40.484491 [debug] [Thread-3 (]: Finished running node test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82
[0m16:11:41.070179 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 7.561 seconds
[0m16:11:41.072583 [info ] [Thread-4 (]: 2 of 8 PASS accepted_values_stg_query_history_execution_status__success__fail__incident  [[32mPASS[0m in 7.63s]
[0m16:11:41.072583 [debug] [Thread-4 (]: Finished running node test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c
[0m16:11:41.073579 [debug] [Thread-2 (]: Began running node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:11:41.073579 [info ] [Thread-2 (]: 5 of 8 START sql table model dbt_JKU.fct_daily_warehouse_costs ................. [RUN]
[0m16:11:41.074576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.snowflake_finops.stg_query_history, now model.snowflake_finops.fct_daily_warehouse_costs)
[0m16:11:41.075602 [debug] [Thread-2 (]: Began compiling node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:11:41.080134 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_finops.fct_daily_warehouse_costs"
[0m16:11:41.082123 [debug] [Thread-2 (]: Began executing node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:11:41.111042 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_finops.fct_daily_warehouse_costs"
[0m16:11:41.113062 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_finops.fct_daily_warehouse_costs"
[0m16:11:41.113062 [debug] [Thread-2 (]: On model.snowflake_finops.fct_daily_warehouse_costs: create or replace transient table FINOPS_DEV.dbt_JKU.fct_daily_warehouse_costs
    
    
    
    as (

with daily_metrics as (
    /* 1. Aggregate staging data to a daily grain per warehouse */
    select
        date_trunc('day', start_time) as cost_date,
        warehouse_name,
        sum(credits_spent) as total_credits_spent
    from FINOPS_DEV.dbt_JKU.stg_query_history
    group by 1, 2
),

final as (
    /* 2. Apply business logic and currency conversion */
    select
        -- Generate a unique ID for this grain (Date + Warehouse)
        md5(cast(concat(coalesce(cast(cost_date as string), ''), '-', coalesce(cast(warehouse_name as string), '')) as string)) as daily_warehouse_id,
        cost_date,
        warehouse_name,
        total_credits_spent,
        -- Assumption: $3.00 per credit (Snowflake Standard pricing)
        -- Calling our Jinja macro for the EUR conversion
        
    /* Generic macro to convert USD amounts to EUR.
       Default rate is 0.92, but can be overridden during the call.
    */
    round(total_credits_spent * 3.00 * 0.92, 2)
 as cost_eur
    from daily_metrics
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "model.snowflake_finops.fct_daily_warehouse_costs"} */;
[0m16:11:48.074047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.971 seconds
[0m16:11:48.074047 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257d4bad-6f0c-4185-8b15-d4bd08178095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C79D3EF0>]}
[0m16:11:48.074047 [info ] [Thread-2 (]: 5 of 8 OK created sql table model dbt_JKU.fct_daily_warehouse_costs ............ [[32mSUCCESS 1[0m in 7.00s]
[0m16:11:48.074047 [debug] [Thread-2 (]: Finished running node model.snowflake_finops.fct_daily_warehouse_costs
[0m16:11:48.074047 [debug] [Thread-3 (]: Began running node test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00
[0m16:11:48.074047 [debug] [Thread-4 (]: Began running node test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc
[0m16:11:48.074047 [debug] [Thread-5 (]: Began running node test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d
[0m16:11:48.074047 [info ] [Thread-3 (]: 6 of 8 START test not_null_fct_daily_warehouse_costs_cost_eur .................. [RUN]
[0m16:11:48.089401 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.snowflake_finops.unique_stg_query_history_query_id.74ccf61b82, now test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00)
[0m16:11:48.074047 [info ] [Thread-4 (]: 7 of 8 START test not_null_fct_daily_warehouse_costs_daily_warehouse_id ........ [RUN]
[0m16:11:48.089401 [debug] [Thread-3 (]: Began compiling node test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00
[0m16:11:48.089401 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.snowflake_finops.accepted_values_stg_query_history_execution_status__success__fail__incident.895a03b21c, now test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc)
[0m16:11:48.089401 [info ] [Thread-5 (]: 8 of 8 START test unique_fct_daily_warehouse_costs_daily_warehouse_id .......... [RUN]
[0m16:11:48.089401 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00"
[0m16:11:48.089401 [debug] [Thread-4 (]: Began compiling node test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc
[0m16:11:48.089401 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.snowflake_finops.not_null_stg_query_history_query_id.a5f2833a4b, now test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d)
[0m16:11:48.089401 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc"
[0m16:11:48.089401 [debug] [Thread-5 (]: Began compiling node test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d
[0m16:11:48.089401 [debug] [Thread-5 (]: Writing injected SQL for node "test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d"
[0m16:11:48.089401 [debug] [Thread-3 (]: Began executing node test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00
[0m16:11:48.105020 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00"
[0m16:11:48.105020 [debug] [Thread-4 (]: Began executing node test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc
[0m16:11:48.105020 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc"
[0m16:11:48.105020 [debug] [Thread-5 (]: Began executing node test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d
[0m16:11:48.105020 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00"
[0m16:11:48.105020 [debug] [Thread-5 (]: Writing runtime sql for node "test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d"
[0m16:11:48.116347 [debug] [Thread-3 (]: On test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost_eur
from FINOPS_DEV.dbt_JKU.fct_daily_warehouse_costs
where cost_eur is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00"} */
[0m16:11:48.118233 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc"
[0m16:11:48.118745 [debug] [Thread-4 (]: On test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select daily_warehouse_id
from FINOPS_DEV.dbt_JKU.fct_daily_warehouse_costs
where daily_warehouse_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc"} */
[0m16:11:48.120341 [debug] [Thread-5 (]: Using snowflake connection "test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d"
[0m16:11:48.121107 [debug] [Thread-5 (]: On test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    daily_warehouse_id as unique_field,
    count(*) as n_records

from FINOPS_DEV.dbt_JKU.fct_daily_warehouse_costs
where daily_warehouse_id is not null
group by daily_warehouse_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "snowflake_finops", "target_name": "dev", "node_id": "test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d"} */
[0m16:11:48.491998 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m16:11:48.491998 [info ] [Thread-3 (]: 6 of 8 PASS not_null_fct_daily_warehouse_costs_cost_eur ........................ [[32mPASS[0m in 0.40s]
[0m16:11:48.491998 [debug] [Thread-3 (]: Finished running node test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00
[0m16:11:48.581338 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m16:11:48.581338 [info ] [Thread-4 (]: 7 of 8 PASS not_null_fct_daily_warehouse_costs_daily_warehouse_id .............. [[32mPASS[0m in 0.49s]
[0m16:11:48.581338 [debug] [Thread-4 (]: Finished running node test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc
[0m16:11:48.601431 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m16:11:48.603452 [info ] [Thread-5 (]: 8 of 8 PASS unique_fct_daily_warehouse_costs_daily_warehouse_id ................ [[32mPASS[0m in 0.51s]
[0m16:11:48.604423 [debug] [Thread-5 (]: Finished running node test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d
[0m16:11:48.605324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:48.605324 [debug] [MainThread]: Connection 'list_FINOPS_DEV' was left open.
[0m16:11:48.605324 [debug] [MainThread]: On list_FINOPS_DEV: Close
[0m16:11:48.979750 [debug] [MainThread]: Connection 'list_FINOPS_DEV_dbt_JKU' was left open.
[0m16:11:48.979750 [debug] [MainThread]: On list_FINOPS_DEV_dbt_JKU: Close
[0m16:11:49.380134 [debug] [MainThread]: Connection 'model.snowflake_finops.fct_daily_warehouse_costs' was left open.
[0m16:11:49.380134 [debug] [MainThread]: On model.snowflake_finops.fct_daily_warehouse_costs: Close
[0m16:11:49.729464 [debug] [MainThread]: Connection 'test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc' was left open.
[0m16:11:49.729464 [debug] [MainThread]: On test.snowflake_finops.not_null_fct_daily_warehouse_costs_daily_warehouse_id.88101eb6fc: Close
[0m16:11:50.082425 [debug] [MainThread]: Connection 'test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d' was left open.
[0m16:11:50.082425 [debug] [MainThread]: On test.snowflake_finops.unique_fct_daily_warehouse_costs_daily_warehouse_id.b24a45761d: Close
[0m16:11:50.453639 [debug] [MainThread]: Connection 'test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00' was left open.
[0m16:11:50.453639 [debug] [MainThread]: On test.snowflake_finops.not_null_fct_daily_warehouse_costs_cost_eur.0d84d65f00: Close
[0m16:11:50.812686 [info ] [MainThread]: 
[0m16:11:50.812686 [info ] [MainThread]: Finished running 1 table model, 6 data tests, 1 view model in 0 hours 0 minutes and 22.05 seconds (22.05s).
[0m16:11:50.812686 [debug] [MainThread]: Command end result
[0m16:11:50.840215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\manifest.json
[0m16:11:50.846118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\semantic_manifest.json
[0m16:11:50.854119 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jksch\Documents\Projects\dbt_projects\dbt_snowflake\snowflake-finops-ae\target\run_results.json
[0m16:11:50.854119 [info ] [MainThread]: 
[0m16:11:50.855116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:50.855116 [info ] [MainThread]: 
[0m16:11:50.856127 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m16:11:50.857111 [debug] [MainThread]: Command `dbt build` succeeded at 16:11:50.857111 after 23.64 seconds
[0m16:11:50.857111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BFACECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C32AC350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C32AE780>]}
[0m16:11:50.858108 [debug] [MainThread]: Flushing usage events
[0m16:11:51.554189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:07.692115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015933B155D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015933F2FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015933F2F190>]}


============================== 10:37:07.707737 | bfd4ea71-e655-41c0-a9cc-4390a001b2fb ==============================
[0m10:37:07.707737 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:37:07.707737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:37:08.136498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfd4ea71-e655-41c0-a9cc-4390a001b2fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159340116D0>]}
[0m10:37:08.173421 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:37:08.175416 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:37:08.178274 [debug] [MainThread]: Command `cli deps` succeeded at 10:37:08.177412 after 0.59 seconds
[0m10:37:08.178551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592D91FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592D91FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592D91FD50>]}
[0m10:37:08.179550 [debug] [MainThread]: Flushing usage events
[0m10:37:08.603404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:40.595856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F52DFEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F52E53050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F52DFE8D0>]}


============================== 12:35:40.611444 | b186d23f-c635-4bfe-a66d-01de1c45b752 ==============================
[0m12:35:40.611444 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:35:40.615067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:35:41.069256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b186d23f-c635-4bfe-a66d-01de1c45b752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F52E94F10>]}
[0m12:35:41.095648 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:35:41.095648 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:35:41.095648 [debug] [MainThread]: Command `cli deps` succeeded at 12:35:41.095648 after 0.62 seconds
[0m12:35:41.095648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F52E22150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4CBB2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4C8CC190>]}
[0m12:35:41.095648 [debug] [MainThread]: Flushing usage events
[0m12:35:41.483135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:37.939686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F87DF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F7ADD810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8813010>]}


============================== 12:37:37.944675 | 73409a17-5819-4910-bb08-38b8d3586bf1 ==============================
[0m12:37:37.944675 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:37:37.945672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:37:38.346357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73409a17-5819-4910-bb08-38b8d3586bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8876410>]}
[0m12:37:38.370214 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:37:38.376928 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:37:38.379497 [debug] [MainThread]: Command `cli deps` succeeded at 12:37:38.378924 after 0.56 seconds
[0m12:37:38.379497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F87DFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8857DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8857C10>]}
[0m12:37:38.380498 [debug] [MainThread]: Flushing usage events
[0m12:37:38.798973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:13.327986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C439F7F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C439F7F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C439F7C390>]}


============================== 12:41:13.327986 | 4f0a6d98-1e8a-4c1b-8fea-133071199cea ==============================
[0m12:41:13.327986 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:41:13.327986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\jksch\\Documents\\Projects\\dbt_projects\\dbt_snowflake\\snowflake-finops-ae\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:13.605657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f0a6d98-1e8a-4c1b-8fea-133071199cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C43A068750>]}
[0m12:41:13.631450 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:41:13.633882 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:41:13.633882 [debug] [MainThread]: Command `cli deps` succeeded at 12:41:13.633882 after 0.43 seconds
[0m12:41:13.633882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C439F84110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C439FF54D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C439FF7A50>]}
[0m12:41:13.633882 [debug] [MainThread]: Flushing usage events
[0m12:41:14.050292 [debug] [MainThread]: An error was encountered while trying to flush usage events
